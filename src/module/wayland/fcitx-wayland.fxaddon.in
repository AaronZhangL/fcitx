[FcitxAddon]
Name=fcitx-wayland
Prefix=Wayland
Include0="wayland-defs.h"
Macro0=FCITX_DISABLE_WAYLAND
Function0=AddTask
Function1=ScheduleFlush
Function2=BindObject
Function3=RegGlobalHandler
Function4=RemoveGlobalHandler
Function5=Sync
Function6=GetDisplay
Function7=GetCompositor
Function8=GetShell
Function9=GetShm
Function10=GetDataDeviceManager
Function11=GetShmFormats
Function12=ReadAll
Function13=
Function14=
Self.Type=FcitxWayland*

[AddTask]
Name=add-task
Return=boolean
Self.Deref=$<->epoll_fd
Self.DerefType=int
Arg0=FcitxWaylandTask*
Arg1=uint32_t
Res.WrapFunc=fx_epoll_add_task
Res.DerefType=int
Res.Deref=$@ == 0

[ScheduleFlush]
Name=schedule-flush
Res.WrapFunc=FxWaylandScheduleFlush

[BindObject]
Name=bind-object
Arg0=uint32_t
Arg1=const struct wl_interface*
Arg2=uint32_t
Self.Deref=$<->registry
Self.DerefType=struct wl_registry*
Return=void*
Res.WrapFunc=wl_registry_bind

[RegGlobalHandler]
Name=reg-global-handler
Arg0=const char*
Arg1=FcitxWaylandHandleGlobalAdded
Arg2=FcitxWaylandHandleGlobalRemoved
Arg3=void*
Arg4=boolean
Return=int
Res.Deref=$@ + 1
Res.DerefType=int
Res.WrapFunc=FxWaylandRegGlobalHandler

[RemoveGlobalHandler]
Name=remove-global-handler
Arg0=int
Arg0.Deref=$0 - 1
Arg0.DerefType=int
Res.WrapFunc=FxWaylandRemoveGlobalHandler

[Sync]
Name=sync
Arg0=FcitxWaylandSyncCallback
Arg1=void*
Return=boolean
Res.WrapFunc=FxWaylandSync

[GetDisplay]
Name=get-display
Return=struct wl_display*
CacheResult=True
Res.Exp=$<->dpy

[GetCompositor]
Name=get-compositor
Return=struct wl_compositor*
CacheResult=True
Res.Exp=$<->compositor

[GetShell]
Name=get-shell
Return=struct wl_shell*
CacheResult=True
Res.Exp=$<->shell

[GetShm]
Name=get-shm
Return=struct wl_shm*
CacheResult=True
Res.Exp=$<->shm

[GetDataDeviceManager]
Name=get-data-device-manager
Return=struct wl_data_device_manager*
CacheResult=True
Res.Exp=$<->data_device_manager

[GetShmFormats]
Name=get-shm-formats
Return=uint32_t
Res.Exp=$<->shm_formats

[ReadAll]
Name=read-all
Arg0=int
Arg1=FcitxWaylandReadAllCallback
Arg2=void*
Arg3=size_t
Return=void*
Res.WrapFunc=FxWaylandReadAll

[FCITX_DISABLE_WAYLAND]
Undefine=@ENABLE_WAYLAND@
